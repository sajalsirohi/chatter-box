{"ast":null,"code":"import _toConsumableArray from\"/home/sajal/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/sajal/Desktop/chat-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{connect}from\"react-redux\";import\"./chat.styles.scss\";import InfoBar from\"../../components/infobar/infobar.component\";import Input from\"../../components/input/input.component\";import Messages from\"../../components/messages/messages.component\";import io from\"socket.io-client\";var socket;var Chat=function Chat(_ref){var joiningDetails=_ref.joiningDetails;var name=joiningDetails.name,roomName=joiningDetails.roomName;var ENDPOINT=\"https://react-redux-chat-appp.herokuapp.com/\";var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];useEffect(function(){socket=io(ENDPOINT);socket.emit(\"join\",{name:name,roomName:roomName},function(){});return function(){socket.emit(\"disconnect\");socket.off();};},[ENDPOINT,name,roomName]);useEffect(function(){socket.on(\"message\",function(message){setMessages([].concat(_toConsumableArray(messages),[message]));});},[messages]);var sendMessage=function sendMessage(event){event.preventDefault();if(message){socket.emit(\"sendMessage\",message,function(){return setMessage(\"\");});}};console.log(message,messages);return/*#__PURE__*/React.createElement(\"div\",{className:\"outer\"},/*#__PURE__*/React.createElement(InfoBar,{name:name,roomName:roomName}),/*#__PURE__*/React.createElement(\"div\",{className:\"inner\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-container\"},/*#__PURE__*/React.createElement(Messages,{messages:messages,name:name}),/*#__PURE__*/React.createElement(Input,{message:message,setMessage:setMessage,sendMessage:sendMessage}))));};var mapStateToProps=function mapStateToProps(state){return{joiningDetails:state.join.joiningDetails};};export default connect(mapStateToProps)(Chat);","map":{"version":3,"sources":["/home/sajal/Desktop/chat-app/client/src/components/chat/chat.component.jsx"],"names":["React","useState","useEffect","connect","InfoBar","Input","Messages","io","socket","Chat","joiningDetails","name","roomName","ENDPOINT","message","setMessage","messages","setMessages","emit","off","on","sendMessage","event","preventDefault","console","log","mapStateToProps","state","join"],"mappings":"oPAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,OAAT,KAAwB,aAAxB,CAEA,MAAO,oBAAP,CAGA,MAAOC,CAAAA,OAAP,KAAoB,4CAApB,CACA,MAAOC,CAAAA,KAAP,KAAkB,wCAAlB,CACA,MAAOC,CAAAA,QAAP,KAAqB,8CAArB,CAEA,MAAOC,CAAAA,EAAP,KAAe,kBAAf,CAEA,GAAIC,CAAAA,MAAJ,CAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAwB,IAArBC,CAAAA,cAAqB,MAArBA,cAAqB,IAC3BC,CAAAA,IAD2B,CACRD,cADQ,CAC3BC,IAD2B,CACrBC,QADqB,CACRF,cADQ,CACrBE,QADqB,CAEnC,GAAMC,CAAAA,QAAQ,CAAG,8CAAjB,CAFmC,cAILZ,QAAQ,CAAC,EAAD,CAJH,wCAI5Ba,OAJ4B,eAInBC,UAJmB,8BAKHd,QAAQ,CAAC,EAAD,CALL,yCAK5Be,QAL4B,eAKlBC,WALkB,eAOnCf,SAAS,CAAC,UAAM,CACdM,MAAM,CAAGD,EAAE,CAACM,QAAD,CAAX,CAEAL,MAAM,CAACU,IAAP,CAAY,MAAZ,CAAoB,CAAEP,IAAI,CAAJA,IAAF,CAAQC,QAAQ,CAARA,QAAR,CAApB,CAAwC,UAAM,CAAE,CAAhD,EAEA,MAAO,WAAM,CACXJ,MAAM,CAACU,IAAP,CAAY,YAAZ,EACAV,MAAM,CAACW,GAAP,GACD,CAHD,CAID,CATQ,CASN,CAACN,QAAD,CAAWF,IAAX,CAAiBC,QAAjB,CATM,CAAT,CAWAV,SAAS,CAAC,UAAM,CACdM,MAAM,CAACY,EAAP,CAAU,SAAV,CAAqB,SAACN,OAAD,CAAa,CAChCG,WAAW,8BAAKD,QAAL,GAAeF,OAAf,GAAX,CACD,CAFD,EAGD,CAJQ,CAIN,CAACE,QAAD,CAJM,CAAT,CAMA,GAAMK,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAW,CAC7BA,KAAK,CAACC,cAAN,GAEA,GAAIT,OAAJ,CAAa,CACXN,MAAM,CAACU,IAAP,CAAY,aAAZ,CAA2BJ,OAA3B,CAAoC,iBAAMC,CAAAA,UAAU,CAAC,EAAD,CAAhB,EAApC,EACD,CACF,CAND,CAQAS,OAAO,CAACC,GAAR,CAAYX,OAAZ,CAAqBE,QAArB,EAEA,mBACE,2BAAK,SAAS,CAAC,OAAf,eACE,oBAAC,OAAD,EAAS,IAAI,CAAEL,IAAf,CAAqB,QAAQ,CAAEC,QAA/B,EADF,cAGE,2BAAK,SAAS,CAAC,OAAf,eACA,2BAAK,SAAS,CAAC,gBAAf,eACA,oBAAC,QAAD,EAAU,QAAQ,CAAEI,QAApB,CAA8B,IAAI,CAAEL,IAApC,EADA,cAEE,oBAAC,KAAD,EACE,OAAO,CAAEG,OADX,CAEE,UAAU,CAAEC,UAFd,CAGE,WAAW,CAAEM,WAHf,EAFF,CADA,CAHF,CADF,CAiBD,CAnDD,CAqDA,GAAMK,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,KAAD,QAAY,CAClCjB,cAAc,CAAEiB,KAAK,CAACC,IAAN,CAAWlB,cADO,CAAZ,EAAxB,CAIA,cAAeP,CAAAA,OAAO,CAACuB,eAAD,CAAP,CAAyBjB,IAAzB,CAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport \"./chat.styles.scss\";\n\n\nimport InfoBar from \"../../components/infobar/infobar.component\";\nimport Input from \"../../components/input/input.component\";\nimport Messages from \"../../components/messages/messages.component\";\n\nimport io from \"socket.io-client\";\n\nlet socket;\n\nconst Chat = ({ joiningDetails }) => {\n  const { name, roomName } = joiningDetails;\n  const ENDPOINT = \"https://react-redux-chat-appp.herokuapp.com/\";\n\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n\n  useEffect(() => {\n    socket = io(ENDPOINT);\n\n    socket.emit(\"join\", { name, roomName }, () => {});\n\n    return () => {\n      socket.emit(\"disconnect\");\n      socket.off();\n    };\n  }, [ENDPOINT, name, roomName]);\n\n  useEffect(() => {\n    socket.on(\"message\", (message) => {\n      setMessages([...messages, message]);\n    });\n  }, [messages]);\n\n  const sendMessage = (event) => {\n    event.preventDefault();\n\n    if (message) {\n      socket.emit(\"sendMessage\", message, () => setMessage(\"\"));\n    }\n  };\n\n  console.log(message, messages);\n\n  return (\n    <div className=\"outer\">\n      <InfoBar name={name} roomName={roomName} />\n\n      <div className=\"inner\">\n      <div className=\"chat-container\">\n      <Messages messages={messages} name={name} />\n        <Input\n          message={message}\n          setMessage={setMessage}\n          sendMessage={sendMessage}\n        />\n      </div>\n        \n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => ({\n  joiningDetails: state.join.joiningDetails,\n});\n\nexport default connect(mapStateToProps)(Chat);\n\n"]},"metadata":{},"sourceType":"module"}